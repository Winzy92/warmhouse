# Project_template

# Задание 1. Анализ и планирование

### 1. Описание функциональности мон
молитного приложения

**Управление отоплением:**

Пользователь может задать желаемую температуру в помещении.

**Мониторинг температуры:**

Система поддерживает мониторинг всех датчиков температуры в реальном времени, как во всем доме, так и в отдельных комнатах.
Дополнительно реализованы методы апи позволяющие добавлять/удалять новые датчики. Но при этом нельзя подключить любой датчик.

### 2. Анализ архитектуры монолитного приложения

Язык программирования: Go.
База данных: PostgreSQL.
Архитектура: Монолитная, все компоненты системы (обработка запросов, бизнес-логика, работа с данными) находятся в рамках одного приложения.
Взаимодействие: Синхронное, запросы обрабатываются последовательно.
Масштабируемость: Ограничена, так как монолит сложно масштабировать по частям.
Развертывание: Требует остановки всего приложения.

### 3. Определение доменов и границы контекстов

- Домен управления устройствами (handlers sensors.go) данный домен ничего не знает о значениях датчиков.
- Поддомен мониторинг температуры (temperature_service.go), получает значения датчиков из внешней системы через http запрос, не управляет устройствами.


### **4. Проблемы монолитного решения**

Судя по заданию на целевую эко систему, в итоговом решении должны быть унифицирована система добавления различного типа устройств (пользователь сам добавляет),
должны быть реализованы новые процессы управления, свет, ворота, видеонаблюдение и пр. С учетом всего этого бизнес рассчитывает на подключение большого количества домов.
Текущая реализация не способна к такому крупному расширению.

- Масштабировать такую систему можно только целиком, и при любом изменении необходимо контролировать регресс
- Добавление новых систем управления, светом, воротами и пр. может быть постепенной, в случае монолита придется обновлять все приложение целиком.
  Это полный перезапуск всей системы управления, что может вызывать недовольство пользователей.
- При выходе в продакшен новой версии, мы, очевидно, столкнемся с большой нагрузкой на апи регистрации новых устройств, в случае если апи не будет справляться, то для устранения этой проблемы нам потребуется больше времени.
  Чем если бы мы вынесли сервис управления датчиками в отдельный микросервис. Можно было бы его горизонтально масштабировать увеличив количество реплик.
- Сейчас скорее всего при отказе одного из компонентов, откажет в целом все приложение.
- С учетом того, что объем нового функционала превышает объем существующего в монолитном решении, смысла его тащить за собой просто нет.

### 5. Визуализация контекста системы — диаграмма С4

```markdown
[As-Is-ContextDiagram.puml](Schemas%2FAs-Is-ContextDiagram.puml)
```

# Задание 2. Проектирование микросервисной архитектуры

**Диаграмма контейнеров (Containers)**

```markdown
[C4Containers.puml](Schemas%2FC4Containers.puml)
```

**Диаграмма компонентов (Components)**

```markdown
[C4ComponentDeviceRegistryService.puml](Schemas%2FC4ComponentDeviceRegistryService.puml)
[C4ComponentDiagramAuthenticationService.puml](Schemas%2FC4ComponentDiagramAuthenticationService.puml)
[C4ComponentDiagramDeviceGateway.puml](Schemas%2FC4ComponentDiagramDeviceGateway.puml)
[C4ComponentDiagramNotificationService.puml](Schemas%2FC4ComponentDiagramNotificationService.puml)
[C4ComponentDiagramTelemetryService.puml](Schemas%2FC4ComponentDiagramTelemetryService.puml)
[C4ComponentDiagramUsersScriptsService.puml](Schemas%2FC4ComponentDiagramUsersScriptsService.puml)
```

**Диаграмма кода (Code)**

```markdown
[C4ClassDiagramDeviceGatewayService.puml](Schemas%2FC4ClassDiagramDeviceGatewayService.puml)
[C4ClassDiagramUsersScriptsService.puml](Schemas%2FC4ClassDiagramUsersScriptsService.puml)
[SequenceDiagramDeviceGatewayService.puml](Schemas%2FSequenceDiagramDeviceGatewayService.puml)
[SequenceDiagramUsersSacriptsService.puml](Schemas%2FSequenceDiagramUsersSacriptsService.puml)
```

# Задание 3. Разработка ER-диаграммы

```markdown
[ERDiagram.puml](Schemas%2FERDiagram.puml)
```

# Задание 4. Создание и документирование API

### 1. Тип API

В моем решении используется смешанная структура, есть как REST API. Для взаимодействия, когда пользователю необходимо получить результат выполнения какой-либо операции прямо сейчас.
А так же я предусмотрел Async API, взаимодействие через кафка. Например пользователь создал скрипт-сценарий который должен выполняться по некому комплексному условию. По условию срабатывает скрипт, и идет асинхронное выполнения ряда команд, есть топик с запросами на изменение значений устройств, есть топик результатами выполнения команды.
Так же через Async API например реализовано получение данных с устройств в режиме real-time.

### 2. Документация API

```markdown
[WarmHouseRestApi.yaml](Schemas%2FWarmHouseRestApi.yaml)
[WarmHouseAsyncApi.yaml](Schemas%2FWarmHouseAsyncApi.yaml)
```

# Задание 5. Работа с docker и docker-compose

Выполнено, пришлось сделать 2 метода апи, так как в изначальной постановке задачи указано получение значения температуры по локации.
Но если покопаться в коде Go то увидим что метод Get All Sensors получает пытается получить информацию по sensorId, код Go трогать не стал просто сделал еще один метод.
Интеграция выполнена.